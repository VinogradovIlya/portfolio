{% extends 'exhibition_app/base.html' %}

{% block title %}Список кошек{% endblock %}

{% block content %}
<div class="container">
    <h1>Список кошек</h1>
    
    <div class="actions">
        <a href="{% url 'exhibition_app:add_cat' %}" class="btn btn-primary">Добавить кошку</a>
    </div>
    
    {% if cats %}
    <div class="cats-grid">
        {% for cat in cats %}
        <div class="cat-card">
            {% if cat.photo %}
            <img src="{{ cat.photo.url }}" alt="Фото кошки" class="cat-photo">
            {% else %}
            <div class="no-photo">Нет фото</div>
            {% endif %}
            
            <div class="cat-info">
                <h3>{{ cat.kitten_breed }}</h3>
                <p><strong>Окрас:</strong> {{ cat.colors }}</p>
                <p><strong>Возраст:</strong> {{ cat.mounts }} месяцев</p>
                <p><strong>Владелец:</strong> {{ cat.kitten_owner.surname }} {{ cat.kitten_owner.name }}</p>
                <p><strong>Описание:</strong> {{ cat.description|truncatewords:10 }}</p>
                
                <!-- Рейтинг -->
                <div class="cat-rating">
                    <p><strong>Рейтинг:</strong></p>
                    <div class="rating-display">
                        {% if cat.average_rating %}
                            <span class="stars">
                                {% for i in "12345" %}
                                    {% if forloop.counter <= cat.average_rating %}
                                        <span class="star filled">★</span>
                                    {% else %}
                                        <span class="star">☆</span>
                                    {% endif %}
                                {% endfor %}
                            </span>
                            <span class="rating-text">{{ cat.average_rating|floatformat:1 }}/5 ({{ cat.ratings_count }} оценок)</span>
                        {% else %}
                            <span class="no-rating">Нет оценок</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <div class="cat-actions">
                <a href="{% url 'exhibition_app:edit_cat' cat.id %}" class="btn btn-secondary">Редактировать</a>
                <a href="{% url 'exhibition_app:add_rating' %}?cat={{ cat.id }}" class="btn btn-info">Оценить</a>
                <form method="post" action="{% url 'exhibition_app:delete_cat' cat.id %}" style="display: inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger" onclick="return confirm('Вы уверены, что хотите удалить эту кошку?')">
                        Удалить
                    </button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="no-cats">
        <p>Кошки не найдены. <a href="{% url 'exhibition_app:add_cat' %}">Добавить первую кошку</a></p>
    </div>
    {% endif %}
</div>
{% endblock %} 